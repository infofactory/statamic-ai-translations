<?php

namespace Infofactory\StatamicAiTranslations;

use Statamic\Facades\CP\Nav;
use Statamic\Facades\Permission;
use Statamic\Providers\AddonServiceProvider;
use Statamic\Statamic;

class ServiceProvider extends AddonServiceProvider
{
    public function bootAddon()
    {
        // Register permissions
        Permission::register('manage ai-translations config')
            ->label('Manage Bard AI Configs');

        // Register navigation
        Nav::extend(function ($nav) {
            $nav->content(__('statamic-ai-translations::cp.title'))
                ->section('Tools')
                ->icon('<svg fill="#000000" version="1.1" viewBox="0 0 256 256" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="m137.56 3.6875c-0.15829 6.01e-5 -0.31218 0.032532-0.46875 0.046875-0.70302 0.00253-1.4059-0.030838-2.1094-0.015625-14.249 0.30816-28.565 3.2287-42.234 8.8906-30.912 12.804-54.165 37.924-65.188 68.25-0.03338 0.08252-0.06464 0.16588-0.09375 0.25-4.5168 12.516-7 25.892-7 39.688-0.0017 2.8743 2.3288 5.2048 5.2031 5.2031 2.8682-7e-3 5.1892-2.3349 5.1875-5.2031 0-11.09 1.7445-21.892 4.9688-32.109h52.891c-1.8712 9.8499-2.9844 20.55-2.9844 32.109-6.47e-4 2.8728 2.3303 5.2038 5.2031 5.2031 2.872-4.3e-4 5.2038-2.3311 5.2031-5.2031 0-11.722 1.1251-22.411 3-32.109h76.844c1.8748 9.6981 3 20.388 3 32.109 0 11.658-1.1517 22.347-3.0938 32.094h-38.328c-2.8743-2e-3 -5.2048 2.3288-5.2031 5.2031-2e-3 2.8743 2.3288 5.2049 5.2031 5.2031h35.875c-11.967 43.811-39.125 65.328-39.125 65.328-0.49833 0.39865-0.87778 0.88913-1.1875 1.4062-0.0265 0.0361-0.0525 0.0726-0.0781 0.10937-0.41582 0.73721-0.61399 1.5581-0.64063 2.3906-0.0164 0.0518-0.0321 0.10392-0.0469 0.15625 0.01 0.047 0.0202 0.0939 0.0312 0.14062 0.0213 0.82673 0.23353 1.6543 0.65626 2.4063 0.0305 0.0474 0.0617 0.0943 0.0937 0.14062 0.11627 0.19184 0.2155 0.38262 0.35938 0.5625 0.39431 0.49291 0.88011 0.87909 1.3906 1.1875 0.0464 0.032 0.0932 0.0633 0.14063 0.0937 0.7553 0.4234 1.5851 0.62503 2.4375 0.64063 0.0311 0.0107 0.0624 0.0211 0.0937 0.0312 47.347-1e-5 90.069-28.539 108.19-72.281 0.74095-1.7889 1.431-3.5968 2.0781-5.4063 0.0468-0.12851 0.0885-0.25882 0.125-0.39062 8.9762-25.379 8.7621-52.587 0.26563-77.219-0.084-0.46574-0.2312-0.91783-0.4375-1.3438-5.7195-15.955-14.945-30.773-27.422-43.25-22.256-22.256-51.985-34.116-82.266-34.266-0.17692-0.018348-0.35204-0.046807-0.53125-0.046875zm13.328 11.25c23.026 2.9009 44.993 13.274 62.125 30.406 9.6669 9.6669 17.166 20.887 22.406 32.953h-51.359c-7.9639-30.779-23.076-51.919-33.172-63.359zm-26.703 0.0625c-10.097 11.456-25.175 32.573-33.125 63.297h-51.297c10.813-24.877 30.886-45.275 56.969-56.078 8.9295-3.6986 18.163-6.0436 27.453-7.2188zm13.375 1.0625c6.0793 5.4672 26.283 25.589 36.047 62.234h-72.094c9.7649-36.646 29.968-56.768 36.047-62.234zm48.844 72.625h52.844c6.5036 20.601 6.7324 42.991 0.0312 64.203h-52.875c1.8711-9.85 2.9844-20.534 2.9844-32.094 0-11.559-1.1132-22.259-2.9844-32.109zm-153.3 39.656c-2.8743-2e-3 -5.2049 2.3288-5.2031 5.2031v10.609h-10.609c-2.8743-2e-3 -5.2049 2.3288-5.2031 5.2031-0.0017 2.8743 2.3288 5.2048 5.2031 5.2031h10.609v10.609c-0.0017 2.8743 2.3288 5.2048 5.2031 5.2031 2.8682-7e-3 5.1892-2.3349 5.1875-5.2031v-10.609h10.609c2.8743 2e-3 5.2048-2.3288 5.2031-5.2031 0.0017-2.8743-2.3288-5.2049-5.2031-5.2031h-10.609v-10.609c0.0017-2.8682-2.3193-5.1962-5.1875-5.2031zm70.672 0.0469c-2.6918 1e-5 -5.3718 1.0124-7.3906 3.0313l-24.75 24.75c-0.02095 0.0155-0.04178 0.0311-0.0625 0.0469-0.01578 0.0207-0.03141 0.0416-0.04687 0.0625l-66.906 66.906c-4.0377 4.0377-4.0377 10.759 0 14.797l13.625 13.625c4.0377 4.0377 10.759 4.0377 14.797 0l91.766-91.766c4.0377-4.0377 4.0377-10.759 0-14.797l-13.625-13.625c-2.0188-2.0188-4.7144-3.0313-7.4062-3.0313zm0 10.312c1e-3 0 1e-3 0.0171 0.0469 0.0625l13.625 13.625c0.0908 0.0908 0.0908 3e-3 0 0.0938l-21.125 21.125-13.719-13.719 21.125-21.125c0.0454-0.0454 0.0454-0.0625 0.0469-0.0625zm80.281 24.594h51.312c-15.113 34.784-47.355 58.603-84.422 63.281 10.095-11.458 25.163-32.575 33.109-63.281zm-108.81 3.9531 13.719 13.719-63.266 63.281c-0.09081 0.0908-0.01858 0.0908-0.10938 0l-13.625-13.609c-0.09081-0.0908-0.09079-0.0186 0-0.10937zm47.438 19.062c-2.8743-2e-3 -5.2048 2.3288-5.2031 5.2031v10.609h-10.609c-2.8743-2e-3 -5.2048 2.3288-5.2031 5.2031-2e-3 2.8743 2.3288 5.2049 5.2031 5.2031h10.609v10.594c-2e-3 2.8743 2.3288 5.2048 5.2031 5.2031 2.8682-7e-3 5.1892-2.3349 5.1875-5.2031v-10.594h10.625c2.8682-7e-3 5.1892-2.3349 5.1875-5.2031 2e-3 -2.8682-2.3193-5.1962-5.1875-5.2031h-10.625v-10.609c2e-3 -2.8682-2.3193-5.1962-5.1875-5.2031zm-31.625 36.891c-2.8743-2e-3 -5.2049 2.3288-5.2031 5.2031v5.3281h-5.3281c-2.8743-2e-3 -5.2048 2.3288-5.2031 5.2031-0.0017 2.8743 2.3288 5.2048 5.2031 5.2031h5.3281v5.3438c-0.0017 2.8743 2.3288 5.2048 5.2031 5.2031 2.8743 2e-3 5.2048-2.3288 5.2031-5.2031v-5.3438h5.3438c2.8743 2e-3 5.2048-2.3288 5.2031-5.2031 2e-3 -2.8743-2.3288-5.2048-5.2031-5.2031h-5.3438v-5.3281c0.0017-2.8743-2.3288-5.2049-5.2031-5.2031z" fill="currentColor"/></svg>')
                ->route('statamic-ai-translations.config')
                ->can('manage ai-translations config');
        });

        // Publish the configs as well
        Statamic::afterInstalled(function ($command) {
            $command->call('vendor:publish', [
                '--tag' => $this->getAddon()->slug().'-config',
            ]);
        });
    }
}
